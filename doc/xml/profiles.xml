<section id="profiles">
  <title>Connecting to the database</title>

  <section id="profile-intro">
    <title>Connection profiles</title>
    <para>&wb-productname; uses the concept of database profiles to store
    connection information. A connection profile stores two different types
    of settings:

    <itemizedlist>
      <listitem><para>JDBC related properties such as the JDBC driver class, the connection URL, etc.</para></listitem>
      <listitem><para>&wb-productname; related properties such as the profile name the associated workspace, etc.</para></listitem>
    </itemizedlist>
    </para>

    <para>After the program is started, you are prompted to choose a
    connection profile to connect to a database. The dialog will display a list
    of available profiles on the left side. When selecting a profile, its details
    (JDBC and &wb-productname; settings) are displayed on the right side of the
    window.</para>

    <para>To create a new profile click on the
    <guibutton>New Profile</guibutton> button (<guiicon>
    <inlinegraphic fileref="@IMAGE_DIR@/New16.gif" format="GIF"/></guiicon>).
    This will create a new profile with the name "New Profile".
    The other properties will be empty. To create a copy of the currently
    selected profile click on the <guibutton>Copy Profile</guibutton> button 
    (<guiicon>
    <inlinegraphic fileref="@IMAGE_DIR@/CopyProfile16.gif" format="GIF"/></guiicon>). 
    </para>

    <para>To delete an existing profile, select the profile in the list and
    click on the <guibutton>Delete Profile</guibutton> button
    (<guiicon><inlinegraphic fileref="@IMAGE_DIR@/Delete16.gif" format="GIF"/></guiicon>)
    </para>
  </section>

  <section id="profile-jdbc-properties">
    <title>JDBC related profile settings</title>
    <informaltable frame="all">
      <tgroup cols="2" align="left">
        <colspec colname="c1" colwidth="3cm" />
        <colspec colname="c2" />
        <thead valign="top">
          <row>
            <entry><para>Property</para> </entry>
            <entry> <para>Description</para></entry>
          </row>
        </thead>
        <tbody valign="top">
          <row>
            <entry> <para>Driver</para> </entry>
            <entry> <para>This is the classname for the JDBC driver. The exact
            name depends on the DBMS and driver combination. The documentation
            for your driver should contain this information. &wb-productname; has some
            drivers pre-configured. See <xref linkend="jdbc-setup"/> for details on
            how to configure your JDBC driver for &wb-productname;.
            </para> </entry>
          </row>
          <row>
            <entry><para>URL</para></entry>
            <entry><para>The connection URL for your DBMS. This value is highly
            DBMS specific. The pre-configured drivers from &wb-productname; contain
            a sample URL. If the sample URL (which gets filled into the text field
            when you select a driver class) contains words in brackets, then these
            words (including the brackets) are placeholders for the actual values.
            You have to replace them (including the brackets) with the appropriate values
            for your DBMS connection</para></entry>
          </row>
          <row>
            <entry><para>Username</para></entry>
            <entry><para>This is the name of the DBMS user account</para></entry>
          </row>
          <row>
            <entry><para>Password</para></entry>
            <entry><para>This is the password for your DBMS user account. You can
            choose not to store the password in the connection profile.</para></entry>
          </row>
          <row>
            <entry><para>Autocommit</para></entry>
            <entry><para>This checkbox enables/disables the Autocommit property
            for the connection. If Autocommit is enabled, then each SQL statement
            is automatically committed on the DBMS. If this is disabled, any DML
            statement (<literal>UPDATE, INSERT, DELETE, ...</literal>) has to be
            committed in order to make the change permanent. Some DBMS
            require a commit for DDL statements (<literal>CREATE TABLE, ...</literal>)
            as well. Please refer to the documentation of your DBMS.</para></entry>
          </row>
          <row>
            <entry><para>Fetch size</para></entry>
            <entry><para>This setting controls the default fetch size 
            for data retrieval. This parameter will directly be passed to the
            <ulink url="http://java.sun.com/j2se/1.4.2/docs/api/java/sql/Statement.html#setFetchSize(int)">setFetchSize()</ulink> 
            method of the <literal>Statement</literal> object.
            For some combinations of JDBC driver and DBMS, setting this parameter to a 
            rather large number can improve retrieval performance because it saves network traffic.
            </para>
            <para>
            The JDBC driver for <ulink url="http://www.postgresql.org/">PostgreSQL</ulink> controls the <ulink url="http://jdbc.postgresql.org/documentation/80/query.html#query-with-cursor">caching</ulink>
            of ResultSets through this parameter. As the results are cached by &wb-productname; 
            anyway, it is suggested to set this parameter to a value greater then zero to disable
            the caching in the driver. Especially when exporting large results using 
            <link linkend="command-export">WBEXPORT</link> or <link linkend="command-copy">WBCOPY</link>
            it is recommended to turn off the caching in the driver (e.g. by setting the value
						for this property to 1).
            </para>
            </entry>
          </row>
          
        </tbody>
      </tgroup>

    </informaltable>

  </section>
  
  <section id="profile-extended-properties">
    <title>Extended properties for the JDBC driver</title>
    <para>Most JDBC drivers support additional connection properties where
    you can fine tune the behaviour of the driver or enable special features
    that are not switched on by default.</para>
    <para>If you need to pass an additional paramter to your driver you can do that
    with the <guibutton>Extended Properties</guibutton> button. After clicking that
    button, a dialog will appear with a table that has two columns. The first column
    is the name of the property, the second column the value that you want to pass to 
    the driver</para>
    <para>To create a new property click on the new button. A new row will be inserted 
    into the table, where you can define the property. To edit an existing property, 
    simply doubleclick in the table cell that you want to edit. To delete an existing property
    click on the <guibutton>Delete</guibutton> button
    (<guiicon><inlinegraphic fileref="@IMAGE_DIR@/Delete16.gif" format="GIF"/></guiicon>).</para>
    
  </section>
  
  <section id="profile-workbench-settings">
    <title>&wb-productname; specific settings</title>

    <section id="profile-save-password">
      <title>Save password</title>

      <para>If this option is enabled (i.e. checked) the password for the
      profile will also be stored in the profile file. If the global
      option <link linkend="options-encrypt-password">Encrypt Passwords</link>
      is selected, then the password will be stored encrypted,
      otherwise it will be stored in plain text!</para>
      <para>If you choose not to store the password, you will be prompted for it each
      time you connect using the profile.</para>
    </section>

    <section id="profile-separate-connection">
      <title>One connection per tab</title>

      <para>If this option is enabled, then each tab in the main window
      will open a separate connection to the database server. This is
      useful, if the JDBC driver is not multi-threaded and does not allow
      to execute two statements concurrently on the same connection.</para>

      <para>The connection for each tab will not be opened until the tab
      is actually selected.</para>
      <para>Enabling this option has impact on transaction handling as well. If 
      only one connection for all tabs (including the <link linkend="dbexplorer">Database Explorer</link>)
      is used, then a transaction that is started in one tab is "visible" to all other tabs
      (as they share the same connection). Changes done in one tab via <literal>UPDATE</literal>
      are seen in all other tabs (including the Database Explorer).
      If a separate connection is used for each tab, then each tab will have its own 
      transaction context. Changes done in one tab will not be visible in other
      tabs until they are committed (depending on the isolation level of the database of 
      course)
      </para>
    </section>

    <section id="profile-ignore-drop-error">
      <title>Ignore DROP errors</title>

      <para>If this option is enabled, any error reported by the database
      server when issuing a statement that begins with DROP, will be
      ignored. Only a warning will be printed into the message area. This
      is useful when executing SQL scripts to build up a schema, where a
      <literal>DROP TABLE</literal> is executed before each <literal>CREATE TABLE</literal>. If the table does
      not exist the error which the <literal>DROP</literal> statement will report, is not
      considered as an error and the script execution continues.</para>
      <para>When running &wb-productname; in batchmode this option can be defined
      using a separate command line parameter. See <xref linkend="using-scripting"/> for details.
      </para>
    </section>

    <section id="profile-ignore-disable-auto-edit">
      <title>Disable automatic update table check</title>

      <para>&wb-productname; automatically tries to determine the table
      which can be updated for a result set. If this check takes too long
      for your DBMS you can disable it. For more details on the automatic
      update check, see <xref linkend="edit-data"/>
      </para>
    </section>

    <section id="profile-rollback-before-disconnect">
      <title>Rollback before disconnect</title>

      <para>Some DBMS require that all open transactions are closed before actually
      closing the connection to the server. If this option is enabled, &wb-productname; 
      will send a <literal>ROLLBACK</literal> to the backend server before
      closing the connection. This is e.g. required for Cloudscape because executing
      a <literal>SELECT</literal> query already starts a transaction. If you see
      errors in your log file while disconnecting, you might need to enable this
      for your database as well.
      </para>
    </section>
    
    <section id="profile-confirm-updates">
      <title>Confirm updates</title>

      <para>If this option is enabled, then &wb-productname; will ask you to confirm
      the execution of any SQL statement that is updating or changing the database in
      any way (e.g. UPDATE, DELETE, INSERT, DROP, CREATE, COMMIT, ...). If you save changes
			from within the result list, you will be prompted even if <link linkend="options-confirm-update">Confirm result set updates</link>
			is disabled.
      </para>
    </section>

    <section id="profile-workspace-file">
      <title>Workspace</title>

      <para>For each connection profile, a workspace file can be assigned. When you
      create a new connection, you can either leave this field empty or
      supply a name for a new profile. </para>
      <para>If the profile you specify does not exist, you will be prompted
      if you want to create a new file, load a different workspace or want to
      ignore the missing file. If you choose to ignore, the association
      with the workspace file will be cleared and the default workspace will be loaded.</para>
      <para>If you choose to leave the workspace file empty, or ignore the missing
      file, you can later save your workspace to a new file. When you do that,
      you will be prompted if you want to assign the new workspace to the current
      connection profile.</para>
      <para> To save you current workspace choose
      <menuchoice><guimenu>Workspace</guimenu><guimenuitem>Save Workspace as</guimenuitem></menuchoice>
      to create a new workspace file.</para>
      <note><para>When specifying the location of the workspace file, you can use the placeholder
      <literal>%ConfigDir%</literal> as part of the filename. The file will then be stored
      in the same directory as &wb-productname;'s configuration files e.g.: <literal>%ConfigDir%/oracle.wksp</literal>
      </para></note>
      <para>
      When you use the <literal>%ConfigDir%</literal> placeholder, you can move the profiles
      and workspaces to a different computer, without changing the location of the workspace files.
      </para>
      <para>The placeholder will be put automatically into the filename
      when you select the location of the profile using the file dialog. The file dialog
      will be opened when you click the button with <literal>...</literal> to the right
      of the input field.</para>
    </section>
  </section>

  <section id="oracle-sysdba-connection">
    <title>Connect to Oracle with SYSDBA privilege</title>
    <para>Connecting to Oracle with SYSDBA privilege can be done by supplying an additional
    property to the driver when connecting.</para>
    <para>In the profile dialog, click on the <guibutton>Extended Properties</guibutton> button.
    Add a new property in the following window with the name <literal>internal_logon</literal>
    and the value <literal>sysdba</literal>. Now close the dialog by clicking on the OK button.
    This property will be passed on to the JDBC driver, which will enable the SYSDBA role when
    connecting to the server.
    </para>
    <para>The profile itself has to use an Oracle user account that is allowed to connect
    as SYSDBA (e.g. SYS).</para>
  </section>

  <section id="oracle-enable-remarks">
    <title>Show table and column comments with Oracle</title>
    <para>By default Oracle's JDBC driver does not return comments made on columns or tables 
    (<literal>COMMENT ON ..</literal>). Thus your comments will not be shown in the database 
    explorer.</para>
    <para>To enable the display of column comments, you need to pass the property <literal>remarksReporting</literal>
    to the driver.</para>
    <para>In the profile dialog, click on the <guibutton>Extended Properties</guibutton> button.
    Add a new property in the following window with the name <literal>remarksReporting</literal>
    and the value <literal>true</literal>. Now close the dialog by clicking on the OK button.
		</para>
		<para>Turning on this features slows down the retrieval of table information e.g. in the Database Explorer.</para>
		<para>When you have comments defined in your Oracle database and use the <link linkend="command-schema-report">WbReport</link>
		command, then you have to enable the remrks reporting, otherwise the comments will not show up in the report</para>
  </section>

  <section id="odbc">
    <title>ODBC connections without a data source</title>
    <para>On Microsoft Windows&reg; you can use the ODBC bridge to connect to
    ODBC datasources. For some drivers you don&#39;t need to create an ODBC
    datasource in order to be able to use the ODBC driver. The following
    URLs can be used to connect to data files directly</para>
    <para>The class name of the driver is <literal>sun.jdbc.odbc.JdbcOdbcDriver</literal></para>

    <informaltable frame="all">
      <tgroup cols="2" align="left">
        <colspec colname="c1" colwidth="2cm" />
        <colspec colname="c2"  />
        <thead valign="top">
          <row>
            <entry>ODBC Connection</entry>
            <entry>URL to be used</entry>
          </row>
        </thead>
        <tbody valign="top">
          <row>
            <entry> <para>Excel</para> </entry>
            <entry><para>jdbc:odbc:DRIVER={Microsoft Excel Driver (*.xls)};DBQ=&#60;filename&#62;</para> </entry>
            </row>
            <row>
              <entry> <para>Access</para> </entry>
              <entry> <para>jdbc:odbc:DRIVER={Microsoft Access Driver (*.mdb)};DBQ=&#60;filename&#62;</para> </entry> </row>
            <row>
              <entry> <para>dBase</para> </entry>
              <entry>  <para>jdbc:odbc:DRIVER={Microsoft dBase Driver (*.dbf)};DefaultDir=&#60;directory where the .dbf files are located&#62;</para></entry>
            </row>
        </tbody>
      </tgroup>
    </informaltable>
  </section>

</section>