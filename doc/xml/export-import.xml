<section id="export-import">
    <title>Exporting and importing data</title>
    <section id="export">
        <title>Export data</title>
        
        <para>You can export the data of the <emphasis role="strong">result set</emphasis> 
            into local files of the following formats:
        </para>
        
        <itemizedlist>
        <listitem>HTML</listitem>
        <listitem>SQL statements (INSERT, UPDATE or DELETE &amp; INSERT)</listitem>
        <listitem>XML format</listitem>
        <listitem>Tab separated text file. Columns are separated with a tab, rows are separated with a newline character</listitem>
        </itemizedlist>

        <para>To save the data from the current result set into an external file, 
            choose <menuchoice><guimenu>Data</guimenu><guimenuitem>Save Data as</guimenuitem></menuchoice>
            You will be prompted for the filename. On the right side of the file dialog
            you will have the possibility to define the type of the export. 
        </para>
        <para>
            The export parameters to the right side are split into two parts. The upper part
            defines parameters that are available for all export types. These are the encoding
            for the file, the format for date and date/time data and the columns 
            that should be exported.
        </para>
        <para>
            All format specific options that are available in the lower part, are also 
            available when using the <link linkend="command-export">WBEXPORT</link> command. 
            For a detailed discussion of the individual options please refer to that section. 
        </para>
        <para>The options <literal>SQL UPDATE</literal> and <literal>SQL DELETE/INSERT</literal>
            are only available when the current result has a single table that can
            be updated, and the primary key columns for that table could be retrieved.
            If the current result does not have key columns defined, you can select
            the key columns that should be used when creating the file. If the current
            result is retrieved from multiple tables, you have to supply a table name
            to be used for the SQL statements.
        </para>
        <para>Please keep in mind that exporting the data from the result set
            requires you to load everything into memory. If you need to export
            data sets which are too big to fit into memory, you should use the 
            <link linkend="command-export">WBEXPORT</link> command to either
            create SQL scripts or to save the data as text or XML files that
            can be imported into the database using the <link linkend="command-import">WBIMPORT</link>
            command.
        </para>
    </section>
    
    <section id="export-clipboard">
        <title>Copy data to the clipboard</title>
        <para>
            You can also copy the data from the result into the system clipboard
            in four different formats. In any case default settings are used
            for the various options of the respective format.
            <itemizedlist>
                <listitem><para>Text (tab separated)</para><para>This will 
                    use a tab as the column separator, and will not quote any values.
                    The end-of-line sequence will be a newline (Unix style) and 
                    the column headers will be part of the copied data. Special
                    characters (e.g. newlines) in the actual data will not
                    be replaced (as it is possible with the <link linkend="text-escape-switch">
                    WBEXPORT</link> command).</para>
                    <para>When you hold down the <keycap>Shift</keycap> key when you 
                    select the menu item, the column headers will not be copied
                    to the clipboard.
                    When you hold down the <keycap>Ctrl</keycap> key when selecting
                    the menu item, you can choose which columns should be copied
                    to the clipboard. Pressing <keycap>Shift</keycap> and 
                    <keycap>Ctrl</keycap> together is also supported.
                    </para>
                </listitem>
                <listitem><para>SQL (INSERT, UPDATE, or DELETE &amp; INSERT)</para>
                    <para>The end-of-line sequence will be a newline (Unix style). 
                    No cleanup of data will be done as it is possible with the <link linkend="export-sql-cleanup">
                    WBEXPORT</link> command, apart from correctly quoting 
                    single quotes inside the values (which is required to generate
                    valid SQL)</para>
                </listitem>
            </itemizedlist>
        </para>
        <para>As with the <literal>Save Data as</literal> command, the options 
            <literal>SQL UPDATE</literal> and <literal>SQL DELETE/INSERT</literal>
            are only available when the current result set is updateable. If no 
            key columns could be retrieved for the current result, you can manually
            define the key columns to be used, using <menuchoice><guimenu>Data</guimenu>
            <guimenuitem>Define key columns</guimenuitem></menuchoice>
        </para>
    </section>
    
    <section id="import">
        <title>Import data</title>
        
        <para>
            &wb-productname; can import tab separated text files into the current
            result set. This means, that you need to issue the approriate <literal>SELECT</literal>
            statement first. The structure of the file has to match the structure of the result set,
            otherwise an error will occur. To initiate the import select
            <menuchoice><guimenu>Data</guimenu><guimenuitem>Import</guimenuitem></menuchoice>
        </para>
        
        <para>When selecting the file, you can change some parameters for the
        import:</para>
        
        <informaltable frame="all">
        <tgroup cols="2" align="left">
            <colspec colname="c1" colwidth="5cm" />
            <colspec colname="c2" colwidth="10cm" />
            <thead valign="top">
                <row>
                    <entry>Option</entry>
                    <entry>Description</entry>
                </row>
            </thead>
            <tbody valign="top">
                <row>
                    <entry><para>Header</para></entry>
                    <entry><para>if this option this is checked, the first line of the import file will be ignored</para></entry>
                </row>
                <row>
                    <entry><para>Delimiter</para></entry>
                    <entry><para>the delimiter used to separate column values. Enter \t for the tab character</para></entry>
                </row>
                <row>
                    <entry><para>Date Format</para></entry>
                    <entry><para>The format in which date fields are specified. The
                    format of this parameter is the same as the SimpleDateFormat class from
                    the JDK.</para></entry>
                </row>
                <row>
                    <entry><para>Number Format</para></entry>
                    <entry><para>The format in which numeric values are specified.
                    Most import if a comma or a point are used as the decimal separator. In
                    the above example a point is used. Enter #,# if a comma is used.</para></entry>
                </row>
                <row>
                    <entry><para>Quote char</para></entry>
                    <entry><para>The character used to quote values with special
                    characters. Make sure that each opening quote is followed by a
                    closing quote in your text file.</para>
                    </entry>
                </row>
            </tbody>
        </tgroup>
        </informaltable>
        <para>
            You can also import text and XML files using the <link linkend="command-import">WBIMPORT</link> 
            command. Using the <literal>WBIMPORT</literal> command is the recommended way to import
            data, as it is much more flexible, and - more important - it does not read the 
            data into memory.
        </para>
    </section>
    
    <section id="xml-export-import" xreflabel="XML Export and Import">
        <title>XML Export and Import</title>
      
        <para>You can use &wb-productname;'s XML files to copy data from
            one system to another.
        </para>
        <para>You need to create the XML file first, using the EXPORT command
            from within the workbench, beeing connected to the source system. Suppose your data
            is stored in the table <literal>PERSON</literal> on your source system
            and you want to only select the columns <literal>lastname, firstname, birthday</literal>
            to be transferred to your target system.
        </para>
       
       <para>To create the XML file the following command should be used:</para>
       
       <programlisting>WBEXPORT -type=xml -file=&quot;c:/data/person.xml&quot; -table=contact;
SELECT lastname, firstname, birthday FROM person;</programlisting>
        <para>As the data should be imported into the table <literal>CONTACT</literal>
            the <literal>-table=contact</literal> parameter is passed to the <literal>EXPORT</literal>
            command. You can achieve the same, by editing the XML file afterwards and
            change the contents of of the <literal>&lt;table-name&gt; </literal> tag.</para>
            <para>Once the XML file is generated, you can connect to your source system and
            import the file with the following command:</para>
            <programlisting>WBIMPORT -type=xml -file=&quot;c:/data/person.xml&quot;;</programlisting>
            <para>&wb-productname; will read the XML file and insert every row into the table <literal>CONTACT</literal>
            of the database. AS the XML format generated by &wb-productname; includes the internal long value for date
            objects, it is not necessary to set the date or datetime format when importing the data.
            If you have a file with a lot of rows, you might want to set the parameter <literal>-commitevery=n</literal>.
            Some DBMS work faster if you commit more frequently instead of commit a huge number of inserts at the end.
            Please refer to the <link linkend="command-export">WBEXPORT command</link> for more details.
        </para>
        <para>If you have XML files in a different format then the one expected by &wb-productname;
            you can transform the file via XSLT into the correct format. More details on how 
            to transform XML files to and from &wb-productname; can be found in the 
            description of the <link linkend="command-xslt">XSLT command</link> and the 
            <link linkend="command-export">WBEXPORT command</link>
        </para>
        
        <para>
            If you want to copy data from one database to another, you can also use the 
            <link linkend="command-copy">WBCOPY</link> command, or the <link linkend="data-pumper">
            DataPumper tool</link>
        </para>
        
    </section>
</section>