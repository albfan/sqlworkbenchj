/*
 * ConnectionInfoPanel.java
 *
 * Created on 29. November 2007, 00:04
 */
package workbench.gui.tools;

import java.sql.DatabaseMetaData;
import javax.swing.JFrame;
import workbench.WbManager;
import workbench.db.DbMetadata;
import workbench.db.WbConnection;
import workbench.gui.WbSwingUtilities;
import workbench.gui.components.ValidatingDialog;
import workbench.log.LogMgr;
import workbench.resource.ResourceMgr;
import workbench.util.StringUtil;

/**
 *
 * @author  support@sql-workbench.net
 */
public class ConnectionInfoPanel
	extends javax.swing.JPanel
{

	public ConnectionInfoPanel(WbConnection conn)
	{
		initComponents();
		productNameLabel.setText(ResourceMgr.getString("LblDbProductName"));
		versionInfoLabel.setText(ResourceMgr.getString("LblDbProductInfo"));
		versionLabel.setText(ResourceMgr.getString("LblDbProductVersion"));
		driverNameLabel.setText(ResourceMgr.getString("LblDriverInfoName"));
		driverVersionLabel.setText(ResourceMgr.getString("LblDriverInfoVersion"));
		urlLabel.setText(ResourceMgr.getString("LblDbURL"));
		userLabel.setText(ResourceMgr.getString("LblUsername"));
		
		try
		{
			DatabaseMetaData meta = conn.getSqlConnection().getMetaData();
			DbMetadata wbmeta = conn.getMetadata();
			
			schemaLabel.setText(StringUtil.capitalize(wbmeta.getSchemaTerm()));
			catalogLabel.setText(StringUtil.capitalize(wbmeta.getCatalogTerm()));
			
			String schema = conn.getCurrentSchema();
			schemaName.setText(schema == null ? "" : " " + schema);
			
			catalog.setText(" " + wbmeta.getCurrentCatalog());
			url.setText(" " + conn.getUrl());
			url.setCaretPosition(0);
			username.setText(" " + conn.getCurrentUser());
			productName.setText(" " + meta.getDatabaseProductName());
			versionInfo.setText(" " + meta.getDatabaseProductVersion());
			versionInfo.setCaretPosition(0);
			dbVersion.setText(" " + conn.getDatabaseVersion());
			driverName.setText(" " + meta.getDriverName());
			driverVersion.setText(" " + meta.getDriverVersion());
			
		}
		catch (Exception e)
		{
			LogMgr.logError("ConnectionInfoPanel", "Could not read connection properties", e);
		}
	}

	public static void showConnectionInfo(WbConnection con)
	{
		ConnectionInfoPanel p = new ConnectionInfoPanel(con);
		JFrame f = WbManager.getInstance().getCurrentWindow();
		ValidatingDialog d = new ValidatingDialog(f, ResourceMgr.getString("LblConnInfo"), p, false);
		d.pack();
		d.setSize(420,d.getHeight());
		WbSwingUtilities.center(d, f);
		d.setVisible(true);
		d.dispose();
	}
	
	/** This method is called from within the constructor to
	 * initialize the form.
	 * WARNING: Do NOT modify this code. The content of this method is
	 * always regenerated by the Form Editor.
	 */
  // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
  private void initComponents() {
    java.awt.GridBagConstraints gridBagConstraints;

    productNameLabel = new javax.swing.JLabel();
    productName = new javax.swing.JTextField();
    versionInfoLabel = new javax.swing.JLabel();
    versionLabel = new javax.swing.JLabel();
    dbVersion = new javax.swing.JTextField();
    driverNameLabel = new javax.swing.JLabel();
    driverName = new javax.swing.JTextField();
    driverVersionLabel = new javax.swing.JLabel();
    driverVersion = new javax.swing.JTextField();
    versionInfo = new javax.swing.JTextField();
    jLabel1 = new javax.swing.JLabel();
    urlLabel = new javax.swing.JLabel();
    url = new javax.swing.JTextField();
    userLabel = new javax.swing.JLabel();
    username = new javax.swing.JTextField();
    schemaLabel = new javax.swing.JLabel();
    schemaName = new javax.swing.JTextField();
    catalog = new javax.swing.JTextField();
    catalogLabel = new javax.swing.JLabel();

    setLayout(new java.awt.GridBagLayout());

    productNameLabel.setText("jLabel1");
    gridBagConstraints = new java.awt.GridBagConstraints();
    gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
    gridBagConstraints.insets = new java.awt.Insets(0, 0, 5, 0);
    add(productNameLabel, gridBagConstraints);

    productName.setEditable(false);
    productName.setText("jTextField1");
    productName.setBorder(javax.swing.BorderFactory.createEtchedBorder());
    productName.setMaximumSize(new java.awt.Dimension(350, 28));
    gridBagConstraints = new java.awt.GridBagConstraints();
    gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
    gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
    gridBagConstraints.insets = new java.awt.Insets(0, 5, 5, 0);
    add(productName, gridBagConstraints);

    versionInfoLabel.setText("jLabel2");
    gridBagConstraints = new java.awt.GridBagConstraints();
    gridBagConstraints.gridx = 0;
    gridBagConstraints.gridy = 1;
    gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
    gridBagConstraints.insets = new java.awt.Insets(0, 0, 5, 0);
    add(versionInfoLabel, gridBagConstraints);

    versionLabel.setText("jLabel3");
    gridBagConstraints = new java.awt.GridBagConstraints();
    gridBagConstraints.gridx = 0;
    gridBagConstraints.gridy = 2;
    gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
    gridBagConstraints.insets = new java.awt.Insets(0, 0, 5, 0);
    add(versionLabel, gridBagConstraints);

    dbVersion.setEditable(false);
    dbVersion.setText("jTextField2");
    dbVersion.setBorder(javax.swing.BorderFactory.createEtchedBorder());
    dbVersion.setMaximumSize(new java.awt.Dimension(350, 28));
    gridBagConstraints = new java.awt.GridBagConstraints();
    gridBagConstraints.gridx = 1;
    gridBagConstraints.gridy = 2;
    gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
    gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
    gridBagConstraints.insets = new java.awt.Insets(0, 5, 5, 0);
    add(dbVersion, gridBagConstraints);

    driverNameLabel.setText("jLabel1");
    gridBagConstraints = new java.awt.GridBagConstraints();
    gridBagConstraints.gridx = 0;
    gridBagConstraints.gridy = 3;
    gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
    gridBagConstraints.insets = new java.awt.Insets(0, 0, 5, 0);
    add(driverNameLabel, gridBagConstraints);

    driverName.setEditable(false);
    driverName.setText("jTextField1");
    driverName.setBorder(javax.swing.BorderFactory.createEtchedBorder());
    driverName.setMaximumSize(new java.awt.Dimension(350, 28));
    gridBagConstraints = new java.awt.GridBagConstraints();
    gridBagConstraints.gridx = 1;
    gridBagConstraints.gridy = 3;
    gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
    gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
    gridBagConstraints.insets = new java.awt.Insets(0, 5, 5, 0);
    add(driverName, gridBagConstraints);

    driverVersionLabel.setText("jLabel2");
    gridBagConstraints = new java.awt.GridBagConstraints();
    gridBagConstraints.gridx = 0;
    gridBagConstraints.gridy = 4;
    gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
    gridBagConstraints.insets = new java.awt.Insets(0, 0, 5, 0);
    add(driverVersionLabel, gridBagConstraints);

    driverVersion.setEditable(false);
    driverVersion.setText("jTextField2");
    driverVersion.setBorder(javax.swing.BorderFactory.createEtchedBorder());
    driverVersion.setMaximumSize(new java.awt.Dimension(350, 28));
    gridBagConstraints = new java.awt.GridBagConstraints();
    gridBagConstraints.gridx = 1;
    gridBagConstraints.gridy = 4;
    gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
    gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
    gridBagConstraints.weightx = 1.0;
    gridBagConstraints.insets = new java.awt.Insets(0, 5, 5, 0);
    add(driverVersion, gridBagConstraints);

    versionInfo.setEditable(false);
    versionInfo.setText("jTextField1");
    versionInfo.setBorder(javax.swing.BorderFactory.createEtchedBorder());
    versionInfo.setMaximumSize(new java.awt.Dimension(250, 28));
    gridBagConstraints = new java.awt.GridBagConstraints();
    gridBagConstraints.gridx = 1;
    gridBagConstraints.gridy = 1;
    gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
    gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
    gridBagConstraints.insets = new java.awt.Insets(0, 5, 5, 0);
    add(versionInfo, gridBagConstraints);
    gridBagConstraints = new java.awt.GridBagConstraints();
    gridBagConstraints.gridx = 0;
    gridBagConstraints.gridy = 9;
    gridBagConstraints.weighty = 1.0;
    add(jLabel1, gridBagConstraints);

    urlLabel.setText("jLabel2");
    gridBagConstraints = new java.awt.GridBagConstraints();
    gridBagConstraints.gridx = 0;
    gridBagConstraints.gridy = 5;
    gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
    gridBagConstraints.insets = new java.awt.Insets(0, 0, 5, 0);
    add(urlLabel, gridBagConstraints);

    url.setEditable(false);
    url.setText("jTextField1");
    url.setBorder(javax.swing.BorderFactory.createEtchedBorder());
    gridBagConstraints = new java.awt.GridBagConstraints();
    gridBagConstraints.gridx = 1;
    gridBagConstraints.gridy = 5;
    gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
    gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
    gridBagConstraints.insets = new java.awt.Insets(0, 5, 5, 0);
    add(url, gridBagConstraints);

    userLabel.setText("jLabel2");
    gridBagConstraints = new java.awt.GridBagConstraints();
    gridBagConstraints.gridx = 0;
    gridBagConstraints.gridy = 6;
    gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
    gridBagConstraints.insets = new java.awt.Insets(0, 0, 5, 0);
    add(userLabel, gridBagConstraints);

    username.setEditable(false);
    username.setText("jTextField1");
    username.setBorder(javax.swing.BorderFactory.createEtchedBorder());
    gridBagConstraints = new java.awt.GridBagConstraints();
    gridBagConstraints.gridx = 1;
    gridBagConstraints.gridy = 6;
    gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
    gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
    gridBagConstraints.insets = new java.awt.Insets(0, 5, 5, 0);
    add(username, gridBagConstraints);

    schemaLabel.setText("jLabel2");
    gridBagConstraints = new java.awt.GridBagConstraints();
    gridBagConstraints.gridx = 0;
    gridBagConstraints.gridy = 7;
    gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
    gridBagConstraints.insets = new java.awt.Insets(0, 0, 5, 0);
    add(schemaLabel, gridBagConstraints);

    schemaName.setEditable(false);
    schemaName.setText("jTextField1");
    schemaName.setBorder(javax.swing.BorderFactory.createEtchedBorder());
    gridBagConstraints = new java.awt.GridBagConstraints();
    gridBagConstraints.gridx = 1;
    gridBagConstraints.gridy = 7;
    gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
    gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
    gridBagConstraints.insets = new java.awt.Insets(0, 5, 5, 0);
    add(schemaName, gridBagConstraints);

    catalog.setEditable(false);
    catalog.setText("jTextField1");
    catalog.setBorder(javax.swing.BorderFactory.createEtchedBorder());
    gridBagConstraints = new java.awt.GridBagConstraints();
    gridBagConstraints.gridx = 1;
    gridBagConstraints.gridy = 8;
    gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
    gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
    gridBagConstraints.insets = new java.awt.Insets(0, 5, 10, 0);
    add(catalog, gridBagConstraints);

    catalogLabel.setText("jLabel2");
    gridBagConstraints = new java.awt.GridBagConstraints();
    gridBagConstraints.gridx = 0;
    gridBagConstraints.gridy = 8;
    gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
    gridBagConstraints.insets = new java.awt.Insets(0, 0, 10, 0);
    add(catalogLabel, gridBagConstraints);
  }// </editor-fold>//GEN-END:initComponents
  // Variables declaration - do not modify//GEN-BEGIN:variables
  private javax.swing.JTextField catalog;
  private javax.swing.JLabel catalogLabel;
  private javax.swing.JTextField dbVersion;
  private javax.swing.JTextField driverName;
  private javax.swing.JLabel driverNameLabel;
  private javax.swing.JTextField driverVersion;
  private javax.swing.JLabel driverVersionLabel;
  private javax.swing.JLabel jLabel1;
  private javax.swing.JTextField productName;
  private javax.swing.JLabel productNameLabel;
  private javax.swing.JLabel schemaLabel;
  private javax.swing.JTextField schemaName;
  private javax.swing.JTextField url;
  private javax.swing.JLabel urlLabel;
  private javax.swing.JLabel userLabel;
  private javax.swing.JTextField username;
  private javax.swing.JTextField versionInfo;
  private javax.swing.JLabel versionInfoLabel;
  private javax.swing.JLabel versionLabel;
  // End of variables declaration//GEN-END:variables
}
